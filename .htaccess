# Enable Rewrite Engine
RewriteEngine On

# Prevent directory listing
Options -Indexes

# Prevent access to .htaccess file
<Files .htaccess>
    Order allow,deny
    Deny from all
</Files>

# Remove .php extension from URLs
# If the request is for a file that doesn't exist, try adding .php
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^\.]+)$ $1.php [NC,L]

# Remove .php extension from existing URLs (redirect)
RewriteCond %{THE_REQUEST} /([^.]+)\.php [NC]
RewriteRule ^ /%1 [NC,L,R=301]

# Force trailing slash removal (optional)
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} (.+)/$
RewriteRule ^ %1 [R=301,L]

# Protect sensitive files and directories
<FilesMatch "\.(sql|log|ini|conf)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Protect config files
<FilesMatch "^(config|config\.php)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Allow access to CSS, JS, images, and other assets
<IfModule mod_headers.c>
    # Cache static assets
    <FilesMatch "\.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$">
        Header set Cache-Control "max-age=31536000, public"
    </FilesMatch>
</IfModule>

# Prevent access to PHP files in php directory directly (optional security)
# Uncomment if you want to prevent direct access to php/*.php files
# RewriteCond %{REQUEST_URI} ^/php/
# RewriteRule ^php/(.*)$ - [F,L]

# Custom error pages (optional)
# ErrorDocument 404 /404.php
# ErrorDocument 500 /500.php

